#!/bin/bash
set -e

# Test large withdrawal transactions. This spends 7 inputs from an older
# Glacier address with uncompressed, non-segwit keys.


# Simulate an earlier, even-larger transaction. These files should
# get deleted by glacierscript.
touch transaction-01.png transaction-02.png transaction-03.png


$GLACIERSCRIPT --regtest=$1 create-withdrawal-data << INPUT 2>&1
y
y
y
y
y
y
2MyCc3oEVwSYzgmspKTjZ6HZrzeg8ajdmKR
52410498137b6223a9fa395e16fe6e49a7f4a737029d4476ec35844a8469e358d641b85a5bf355d570699d63cde87da1d450e1966d97ee61a99b51995a11eb7ea0f6744104fd9a69f95e31c3b8d2c97925e0f151dd1c67f3b71e3ba6db8f20d944e6e94d9b5e3ad4c12a5f9bd6d2137cf69b015f9637de61aafae29fdfccf8ef5a4cd81e374104ff188a131ee79900a4cdbe68c5ea84ad73b8acf8414e5895f6c7b0e4779ef50d39ba369a34cd3f7216877769a292ccf52c2653c799a138321bf8c1e03a9120594104eeafc0621008662a9977b953ee7f7af87981830f561cac50387211c75d58bcb751414fc9abe0cf4a28a4044806ccd54b3f80ba990e0eff046bb1b930968b973a54ae
bcrt1qrwxllgvtc0ns624dlped894kkfq608jmye2k50
7
020000000001013068db531b76f75e9472416e1c5df5f0d045a1f0aafe242677563cc25a7b155d0100000000ffffffff0242e419000000000017a914385ceedba0a97aa2d9ae88f8140ddd9524e6cdd88740420f000000000017a9144151ec0c95327edca1c4c5d38d01e00d9ec93d57870247304402202b6b6d5e2962f03c7cf3d88b582355ade02c0b3b559213423be57c43131694cc022066a01d0a0a4596b9ab328332af5f3fd5ae3d5e8a8e281cb01fdb9137662ca9b0012102f5455327f645f6b6c44fbaf03d56fd65cba828961239960a3284cd43a889057300000000
0200000000010196c82adec5ccee03d5b82e631789471d59dc920f8073d24d1f6f209372fc82370100000017160014713a9050f95ee7ce6da75ecd2713bc809f184118ffffffff02866072000000000017a914f3fadb6de38d8a2f3cfac4c96eb6822ed88e44b38740420f000000000017a9144151ec0c95327edca1c4c5d38d01e00d9ec93d57870247304402205b16df10f4318550816bbc4004c1f844b99206d129559b29ca098c678f426ba7022041cd62d716c8754999dcb63616710fc7ffda8e8a1c6dc062b9323ddc0502bdf8012102a19f9119892ec588beacf5c39fed2c37bdd7318037e88e394052ccc86858129700000000
02000000000101c21442f8d808c6dbdb1db4997cf9fde036d53466c122481ad12777ea1b36532c0100000000ffffffff0290c4c0010000000017a91406eef6c60b644bb80f28af6953bc407fb70757fa8750690f000000000017a9144151ec0c95327edca1c4c5d38d01e00d9ec93d57870247304402200e22621097912987c54e4657d7de7c2a4bb730f1903bf082caec69820ff50e7d0220474bb156e4534bf8f0549eaa18edf6d811109d91ad1d6211a644115c2af13c260121029860dc0d45559ab5a2ef437f9ff1ec4f867c5b9fe30cb3dee408aa2d11ad4c2700000000
02000000000101ce1acb920423875f9ae1c53aa0a0c1e3f24f5b3a59cc6acf10b47d1d9dc9c49b0100000017160014023e4b8e3e3b3432beecf3ebe95876690dbfbd1fffffffff0280de0f000000000017a9144151ec0c95327edca1c4c5d38d01e00d9ec93d5787608162000000000017a914b831ebd24f0a47a9e610e173f9e93083b6f8786887024730440220447f01a0a25feaa52117a280e17e44f9b918f7ac3607341651428b3cc1d5449402200629a98ad59638b1d09725450d723babf9653c344706f94d9895f43fcda66a54012102830fb7998dd6d3a4686fe31832e9255ea5efafd79448a5b5f0958ad5cdbbcd5a00000000
0200000000010147c3e825a485f164e7b2d3dd0b5c340bed3a119168a98a8f7909a4fbc01df31e01000000171600148a6c1aa3af05f9da1d05545d7f2634c468f90df8ffffffff022a7b52000000000017a914b330855b088486013ed13bf2cfd134c516f48cda87900510000000000017a9144151ec0c95327edca1c4c5d38d01e00d9ec93d57870247304402202f2e9d3f3d4d9dcdda251abe418433f0f18bc4b1ad59ddfcb636937cbda9c41902203eb9e24da8cc1cc5b2e196006dabb43e6b4e9703b41daa79186e0ba9f318e150012103595c5f5649e7a92aab69a9b1e9c1e6b8a486de71de804488499c2c6fbe41d30200000000
0200000000010103d7d54dc0f570c7beaf62a04b2c6497ee51b9ff6b12da26b0b92d0e67dbf5f00100000017160014e47ceb06bc19e2ca4327b1cd7fe9c30b7266a323ffffffff02a02c10000000000017a9144151ec0c95327edca1c4c5d38d01e00d9ec93d57874a97b0010000000017a9141a4274c41f51b370c0370b4dd58608575f36c14687024730440220578a53c9e4199a9d2d2c2192077b0357a9916ef873dc0fbec7a38c821104ed5c02203da9ae1e2061d7ebd7409166258dc57f961fa3fdc0b4f157cd5ba675911cfc5f012103db82b75ec69868dd2d9d54652b8c0c081c72249a36c62db4b653cfb51bd208d600000000
02000000000101bdd3cc88a59bb6fb3394bc0f4c0cde72fe85043c337755443117538fc18cbb6901000000171600149dd2579d7b67fa89a69030220ed0a03efc7c9043ffffffff02b05310000000000017a9144151ec0c95327edca1c4c5d38d01e00d9ec93d5787f442a0010000000017a914e62ccee61b66e8ee7062018a1db17294b22396c88702473044022014fdd741b6ae98a0d2871cd2058671a0802cd5010ab03fe96efd3ddf9756a3a602206f61de867d65182c5f7b803529487be143941b4b02a9e6ed2c3f410397c6b528012102e0ff4bd2ea8884f978b80dfd0ce9e5b0aa211942471180874a002172e7694d0400000000
2
93VDtjySSuPjgLYyCR6BBTqCuaqu6X728ZfkNEDbgAdVURRd1rS
924WjH7yMYyuyhUougBHEu2vThcHRmahF6FsKvNVQBwSGuEyqKm
1
y

y
INPUT

ls -1 transaction*.png
