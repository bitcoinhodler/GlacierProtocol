#!/bin/bash
set -e

# Test large withdrawal transactions. This spends 7 inputs from an older
# Glacier address with uncompressed, non-segwit keys.


# Simulate an earlier, even-larger transaction. These files should
# get deleted by glacierscript.
touch transaction-01.png transaction-02.png transaction-03.png


$GLACIERSCRIPT --regtest=$1 create-withdrawal-data << INPUT 2>&1
y
y
y
y
y
y
2MyCc3oEVwSYzgmspKTjZ6HZrzeg8ajdmKR
52410498137b6223a9fa395e16fe6e49a7f4a737029d4476ec35844a8469e358d641b85a5bf355d570699d63cde87da1d450e1966d97ee61a99b51995a11eb7ea0f6744104fd9a69f95e31c3b8d2c97925e0f151dd1c67f3b71e3ba6db8f20d944e6e94d9b5e3ad4c12a5f9bd6d2137cf69b015f9637de61aafae29fdfccf8ef5a4cd81e374104ff188a131ee79900a4cdbe68c5ea84ad73b8acf8414e5895f6c7b0e4779ef50d39ba369a34cd3f7216877769a292ccf52c2653c799a138321bf8c1e03a9120594104eeafc0621008662a9977b953ee7f7af87981830f561cac50387211c75d58bcb751414fc9abe0cf4a28a4044806ccd54b3f80ba990e0eff046bb1b930968b973a54ae
bcrt1qrwxllgvtc0ns624dlped894kkfq608jmye2k50
7
0200000000010131d15907a59d3a4fc5a099b625442490bbdf12ff1d53859ba332669c9f8476430100000000ffffffff0242e419000000000017a914909da39f28768959dd4038184ca930fa1a3158e18740420f000000000017a9144151ec0c95327edca1c4c5d38d01e00d9ec93d57870247304402203c232673931943c8d7a9943ad69e19a3e4086856664f077969d14b6619f9f21a02205117a8fff759b1ccd52da41edd8be191a72cbf269d1043e242884e1723e2b7d5012103fa2a55f9347e352ba0216721011d1725c7c94f6c501a04970179feedf9ace83e00000000
020000000001013495952c788021c0c3ad62ff69dd85662d36ff443dbdfe09bd1961053927383e0100000017160014b37e2afe18e397024186746a26c24ba32840475cffffffff02866072000000000017a9140a5b7d0740553ce017e16efbb83c445c82e033358740420f000000000017a9144151ec0c95327edca1c4c5d38d01e00d9ec93d57870247304402202f2080e7670ec8306ced048a607da6d7035351488bf0ce1f3e34097638d971950220489fee122c569d5c736ef815918b8884280f4be7e4bced71dd39df5858f20be201210242e01eef2dabd8eae62de2876ff7f9937961d45834a88d7abf179b759e53720f00000000
02000000000101d4236e269dfd1c82b7043d9330bc58747e05f5f0562ade33d08b232be10a977f0100000000ffffffff0290c4c0010000000017a914823334a1020e7137699b18bdb1b05ec9e6ea71028750690f000000000017a9144151ec0c95327edca1c4c5d38d01e00d9ec93d57870247304402203ed039070a65f06a9414bfad3ae0ed9bd164a01bb40b6663bcb38e4e9a6a43a602202b415fc56fb40b36a51d7c29244dfee1f937dea95753c9c39989b4a3b7ab10a9012102e6df1c0ca070c76b0a481ab58475371c68e8d4e24c11cfae421bf040099fdad800000000
0200000000010191df854c18ebac4ca0ecf65a2546d8dae96c75d1e05e54537e6915f45e4825c60100000017160014a9d31b7bb65565921febc103586683f817e68e8dffffffff0280de0f000000000017a9144151ec0c95327edca1c4c5d38d01e00d9ec93d5787608162000000000017a914fde897207d078c72e5c6b6059c717794b672866a87024730440220202cc05cf947adfffb5101748b162d3ad3694d2695b7d00ebac0a8f9ab9269a402200349fd8db892d597df7e0c814ea02110caf7a455d71017d7a9a77815337943d5012102df86c2ce392120237582a3db1906286aabd24f6c48eddd52b6b503e736dc471100000000
02000000000101858ef4a74f1b125c3cf6b19f7f333fe25af81b0760d003055d3f87ff0e86e7ad01000000171600145d0d2d84919a552428eadda100a2b3dcf05eea44ffffffff022a7b52000000000017a91424b3c2795f540a5e1fede2383be05b4baa967fd487900510000000000017a9144151ec0c95327edca1c4c5d38d01e00d9ec93d5787024730440220683abb7d59280b665d5e29d5911000115e1eb46b2eb1833809b06b7029216d670220736538eee00ab4b72765dcf211218fef99fba3c1c14684cb7b097ee67a18eb200121032a6a8ceef9ea895a8906803501fec1c5b567e6929f48b68ef5aeaf8bd1de1ac800000000
020000000001014ae0466c5d62c38b53f5463387560e84d14a4f44ec5a380fb8d5c7b1f312037b0100000017160014a9be2dc4a9dfb8c1c97e76d8145f6446233d5651ffffffff02a02c10000000000017a9144151ec0c95327edca1c4c5d38d01e00d9ec93d57874a97b0010000000017a914c63d4049f9cc5af0b16f52122e1c03409428f56f8702473044022041c200c07fa3d645d56020c2fd8083f47e4e6b8e6a48107aae90e9cf76fac30502202197929f868b23543f95b809043210546ed297a964328b356e18b5ecf3f93f270121021f38a0daa95c373298c3366ba0549264c27788f476dd19caf9b1bffe0abd960c00000000
02000000000101e768a844eaed13fe500de96dff871c850fe0b8c71738f791c68e81dc6a50abce0100000017160014f0e663295fe87b0a90931bb7700d336a42f75c04ffffffff02b05310000000000017a9144151ec0c95327edca1c4c5d38d01e00d9ec93d5787f442a0010000000017a9149e07ee8e345c6d9443ce7423777fb30567b333f28702473044022035a8156f1d29b6e7ccb18e2cfe1c28557feb2cbc3b62945bafc9c99d79d10189022075f66fdaa1e1808e64c5b8d08a5cfa6ef211b42c4fa6a9878cbddf6c1d163dcf0121020286a66885128a3b2ed98c98eeb425246897d4da0a27d1c25aecd4100a1fac2c00000000
2
93VDtjySSuPjgLYyCR6BBTqCuaqu6X728ZfkNEDbgAdVURRd1rS
924WjH7yMYyuyhUougBHEu2vThcHRmahF6FsKvNVQBwSGuEyqKm
1
y

y
INPUT

ls -1 transaction*.png
