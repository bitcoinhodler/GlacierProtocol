#!/bin/bash
set -e

# Test large withdrawal transactions. This spends 7 inputs from an older
# Glacier address with uncompressed, non-segwit keys.


# Simulate an earlier, even-larger transaction. These files should
# get deleted by glacierscript.
touch transaction-01.png transaction-02.png transaction-03.png


$GLACIERSCRIPT --regtest=$1 create-withdrawal-data << INPUT 2>&1
y
y
y
y
y
y
2MyCc3oEVwSYzgmspKTjZ6HZrzeg8ajdmKR
52410498137b6223a9fa395e16fe6e49a7f4a737029d4476ec35844a8469e358d641b85a5bf355d570699d63cde87da1d450e1966d97ee61a99b51995a11eb7ea0f6744104fd9a69f95e31c3b8d2c97925e0f151dd1c67f3b71e3ba6db8f20d944e6e94d9b5e3ad4c12a5f9bd6d2137cf69b015f9637de61aafae29fdfccf8ef5a4cd81e374104ff188a131ee79900a4cdbe68c5ea84ad73b8acf8414e5895f6c7b0e4779ef50d39ba369a34cd3f7216877769a292ccf52c2653c799a138321bf8c1e03a9120594104eeafc0621008662a9977b953ee7f7af87981830f561cac50387211c75d58bcb751414fc9abe0cf4a28a4044806ccd54b3f80ba990e0eff046bb1b930968b973a54ae
bcrt1qrwxllgvtc0ns624dlped894kkfq608jmye2k50
7
0200000000010117cc27e3f5042a6502e5faec7fc12e44dc933fce75ca7971fb6fb481df3561600100000000ffffffff0242e419000000000017a914385ceedba0a97aa2d9ae88f8140ddd9524e6cdd88740420f000000000017a9144151ec0c95327edca1c4c5d38d01e00d9ec93d57870247304402200714f6af838f4d1df221095fb0e22a185de733c8f16b1ef3b65773c1c05e085b022047225e704c3ceb8b8d83d5a6b5824154baf3fb691e2c3ebe5152d1d11a3dc78c012102f5455327f645f6b6c44fbaf03d56fd65cba828961239960a3284cd43a889057300000000
02000000000101be30567e2748b8315d44ede1e729e7144f2c53b3f83e62561a4d8e67477d0abc0100000017160014713a9050f95ee7ce6da75ecd2713bc809f184118ffffffff02866072000000000017a914f3fadb6de38d8a2f3cfac4c96eb6822ed88e44b38740420f000000000017a9144151ec0c95327edca1c4c5d38d01e00d9ec93d578702473044022022ae9f7c93c32f4746d82140a7958ba617567b34c07bfe7452cb5ccfa8dda3c102204fa070ccb0cdd76d42dc2c6c31e32675bdd35337aed9bb82e6ab5942940e2200012102a19f9119892ec588beacf5c39fed2c37bdd7318037e88e394052ccc86858129700000000
020000000001010e00de4cedad146e5762aae8f6f6c395e597a4373f0db26b47c0581ade429e700100000000ffffffff0290c4c0010000000017a91406eef6c60b644bb80f28af6953bc407fb70757fa8750690f000000000017a9144151ec0c95327edca1c4c5d38d01e00d9ec93d5787024730440220565f2ac28f5972035dcd16cf5a35bd4d41424af9bf502cbdc36d99840b6a6daf02204d3c2f2b660024adf7b9092a0b06130210727520f15d0b51a94b63f0e204d8fb0121029860dc0d45559ab5a2ef437f9ff1ec4f867c5b9fe30cb3dee408aa2d11ad4c2700000000
0200000000010109ad1ea5e3ec29d432e528c517abce3819715e3b83cd0ea5d399d4082f4344dd0100000017160014023e4b8e3e3b3432beecf3ebe95876690dbfbd1fffffffff0280de0f000000000017a9144151ec0c95327edca1c4c5d38d01e00d9ec93d5787608162000000000017a914b831ebd24f0a47a9e610e173f9e93083b6f87868870247304402201e7d2b423b6388297f05cb114b09b92cd72e8fd5c53d63c3a8a1cb1872095bd002200305c60eb6c61013f57d714521be6d6d8dc112bfda53cca5547ae40271b41736012102830fb7998dd6d3a4686fe31832e9255ea5efafd79448a5b5f0958ad5cdbbcd5a00000000
02000000000101e1e0d3683e53e5b286900db418b64854f93159b15b6068931e7b5938184c3cf301000000171600148a6c1aa3af05f9da1d05545d7f2634c468f90df8ffffffff022a7b52000000000017a914b330855b088486013ed13bf2cfd134c516f48cda87900510000000000017a9144151ec0c95327edca1c4c5d38d01e00d9ec93d57870247304402206d6abd9c63ccbce641a34fdd52cea0f58e0da9735dd525d66e16825401b7989a02205de70c5c3f990365d4a22f2ce5622e120bd8c9da7143cae1ea2e9cc9912f1fed012103595c5f5649e7a92aab69a9b1e9c1e6b8a486de71de804488499c2c6fbe41d30200000000
020000000001015856f2736edf390a301ac21d430c733a789ce4535424d8d6d8e66c23c901851d0100000017160014e47ceb06bc19e2ca4327b1cd7fe9c30b7266a323ffffffff02a02c10000000000017a9144151ec0c95327edca1c4c5d38d01e00d9ec93d57874a97b0010000000017a9141a4274c41f51b370c0370b4dd58608575f36c146870247304402203b0eb00cc07729f4e3456807289fbe1150678f783b0dcd736c66855523818fee022049546a04dc41a3c1b1859d03124ae2509b4747eac207e95ef3732ba9f46f7e17012103db82b75ec69868dd2d9d54652b8c0c081c72249a36c62db4b653cfb51bd208d600000000
02000000000101430b7e02c7ae4fc4c4b95b041b23f469bf7b4b6e221cc59803432bb7bd053b5201000000171600149dd2579d7b67fa89a69030220ed0a03efc7c9043ffffffff02b05310000000000017a9144151ec0c95327edca1c4c5d38d01e00d9ec93d5787f442a0010000000017a914e62ccee61b66e8ee7062018a1db17294b22396c887024730440220078f40f35cc44c5ce0fc60575924c27e6e377b582cbb58c491ccbb749ff3d6e502204d584ae427c8513528fb51fbe51875ef078005e0e707c3baf180b9a695f9eaa5012102e0ff4bd2ea8884f978b80dfd0ce9e5b0aa211942471180874a002172e7694d0400000000
2
93VDtjySSuPjgLYyCR6BBTqCuaqu6X728ZfkNEDbgAdVURRd1rS
924WjH7yMYyuyhUougBHEu2vThcHRmahF6FsKvNVQBwSGuEyqKm
1
y

y
INPUT

ls -1 transaction*.png
