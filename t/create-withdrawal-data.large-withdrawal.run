#!/bin/bash
set -e

# Test large withdrawal transactions. This spends 7 inputs from an older
# Glacier address with uncompressed, non-segwit keys.


# Simulate an earlier, even-larger transaction. These files should
# get deleted by glacierscript.
touch transaction-01.png transaction-02.png transaction-03.png


$GLACIERSCRIPT --regtest=$1 create-withdrawal-data << INPUT 2>&1
y
y
y
y
y
y
2MyCc3oEVwSYzgmspKTjZ6HZrzeg8ajdmKR
52410498137b6223a9fa395e16fe6e49a7f4a737029d4476ec35844a8469e358d641b85a5bf355d570699d63cde87da1d450e1966d97ee61a99b51995a11eb7ea0f6744104fd9a69f95e31c3b8d2c97925e0f151dd1c67f3b71e3ba6db8f20d944e6e94d9b5e3ad4c12a5f9bd6d2137cf69b015f9637de61aafae29fdfccf8ef5a4cd81e374104ff188a131ee79900a4cdbe68c5ea84ad73b8acf8414e5895f6c7b0e4779ef50d39ba369a34cd3f7216877769a292ccf52c2653c799a138321bf8c1e03a9120594104eeafc0621008662a9977b953ee7f7af87981830f561cac50387211c75d58bcb751414fc9abe0cf4a28a4044806ccd54b3f80ba990e0eff046bb1b930968b973a54ae
bcrt1qrwxllgvtc0ns624dlped894kkfq608jmye2k50
7
02000000000101b2266908a12dbc958ae9f93fdff76935584ff99b661b6b196a9d9154bfbeef800100000000ffffffff0242e419000000000017a914da4e40d88ef0988fca356b0e2360d070d5c285af8740420f000000000017a9144151ec0c95327edca1c4c5d38d01e00d9ec93d5787024730440220798485f9b5aff23657cd94e7cb53f9aea5d915a3a8cc70cd397766bc228667f2022012416b4ed321d0b5c08316136969892efcaacefe6689e24a2c78730a8b344df60121032820c46c9145e54291f399ec5af0e60e7eb24b24f61f761a4f02f7e6fd471aa100000000
02000000000101939d188a2dfa3d9dbbcd0a93c713dd4ea655b0d2e2d858989f307839b6178a620100000017160014758f30305c5d902c4ed3f055ecd9927ffc45657effffffff02866072000000000017a91420a27ad0500d02b62b5d0a086e706d56b9e97be78740420f000000000017a9144151ec0c95327edca1c4c5d38d01e00d9ec93d57870247304402204f77475446fddcbcc018d2ba0e9d7f23c06f6eb381e3d29de32a0b0b491ed3eb02200387685e5b2428118fb881cbfdad0eda903891a13f9749ebf5c5a0a4041824e1012103653a4a0e754cbf7fc70a2af21e34426fe49866fa3cbb5a0c9c8ebf4a31b784c300000000
020000000001017617b1cddbe5fe53afe7bf59d0fa1eaa09cb7c1d996dce3ef5a7a0360b9f998f0100000000ffffffff0290c4c0010000000017a9140f8c1c505f50c1a2917730a6a4261b4b0acf1a028750690f000000000017a9144151ec0c95327edca1c4c5d38d01e00d9ec93d578702473044022036ca32c568350562f39ea20ac9198454c83daca43e1d2024c16743f5fc82134102203cfd3194f60d0598382cce3494219e8694b9aee9bf1559c16bc880509313ac3a012103555cc1e01daf8b47d1df7c02601544e0e560dadbeb8dfc243583684d9adde3f900000000
020000000001011a21704fbaf76c4b5de17e352d1fd0de3b888bbdace438592a4b8d5b374a57a50100000017160014c4204a8753de3de304ab8d5521aade6b86c5f193ffffffff0280de0f000000000017a9144151ec0c95327edca1c4c5d38d01e00d9ec93d5787608162000000000017a914f970756cc500bea8d0afbb8ac8a705fa99b16229870247304402204e4ca3e7a367c90720f19efcece02c38268bde80ec91de13a71268d84fcdfbc40220672b081b4e6d63ea65120ec6ed36a4afdfcd90756c711e4b62f5fd9528fcf3ff012102d5d7adeed6958416381d9fccd6d67c9fa540fd8fd2df1317d1e29fd71e225e1b00000000
020000000001018f002c54db19abdace58f7e9109fb7d5bb8d1201efea766385409160db30434d01000000171600149834869eb963c9d406e4a98ae59a66046c0cc0e8ffffffff022a7b52000000000017a9147ba9e41741972d1d7165aa0e06e4028a2fb7b32587900510000000000017a9144151ec0c95327edca1c4c5d38d01e00d9ec93d578702473044022012aa1a90b2ebcbc3db707fa5615ac6badf6eec874d9ae3fd764dae2b785877e402203061a58387088eb858b699e5ecf7328bc48c9292cb807a4ad7274c819f58c58a012103374b18c8cfcb9b5c84925620212fac29454de34960573178abce2718cd62324200000000
02000000000101309b1a74c5403a413ad42869bd8fb3b4e3afd5e016e6e4db480d42f08035add30100000017160014d9d620b35ec82ac7f6d508b906fbeb28e96b5d64ffffffff02a02c10000000000017a9144151ec0c95327edca1c4c5d38d01e00d9ec93d57874a97b0010000000017a9142ef4a5e7f2712994897bfc70c396916de4ccad798702473044022076d2b9972fccff15456ef8eb2f3012fc2433a967a395d76c2b492a7602898b2f022047aa8d8ceeef8f835668faf9956760ce7c13bb3251a0950301c6e36d5b7e42dd01210357572283070913fbce00358a1be0ec3d3b65701e87e6cf8327d2995d927cb16000000000
020000000001018731c7a1486d405094067303dd29403fb0c34c15aebf909c469f4c219b7b3fdf010000001716001447f45d15f1eb4fd62601dfb39b8f03e74c0853c0ffffffff02b05310000000000017a9144151ec0c95327edca1c4c5d38d01e00d9ec93d5787f442a0010000000017a91479d798c739948467f4bf706c4cc22f1b7e04eb23870247304402205a9ff0a507559936cc316986f85588d2b81d1adf00b03da611f8e59879a64eaa02201f009a5c22e844b3cf76ef66f665df74fb013c905d5f5721bcbf229700ae53df0121035a1058638cf7078a2c8655e0cf1258b4490ec0bbb1d8bb4d8943c8b5aaae5db900000000
2
93VDtjySSuPjgLYyCR6BBTqCuaqu6X728ZfkNEDbgAdVURRd1rS
924WjH7yMYyuyhUougBHEu2vThcHRmahF6FsKvNVQBwSGuEyqKm
1
y

y
INPUT

ls -1 transaction*.png
