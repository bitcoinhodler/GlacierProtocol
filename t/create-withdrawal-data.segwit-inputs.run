#!/bin/bash
set -e

# Test withdrawing from transactions that were created by SegWit wallets.
# I have four transactions to try:
# 1. Electrum p2wpkh-in-p2sh with change
# 2. Electrum native p2wpkh with change
# 3. Electrum p2wpkh-in-p2sh with no change
# 4. Electrum native p2wpkh with no change


$GLACIERSCRIPT --regtest=$1 create-withdrawal-data << INPUT 2>&1
y
y
y
y
y
y
2NAVkgszAvjZZwWpHpbCaxSaNqCCXPD8Bts
522103d14ddcfb6817f5579695bbb3eb3e185887bf2942b031e6f716343b8fe7e9e8e221028fcd46f8614b2cbf318096968242a1e22bcfb6d8f2b6dc939c8c27c347b2937b210315acb550120f4cdcb460d5c49080ab508ca4ccd8dedecac22feeac8cd017d4c121022b063ee2f22f9e1982c140fe778672c683111a796dcccdbd47bb65e3d608a98354ae
2N5PvoFj6adLPcqHAD24MxEZxvdQMGBLXow
4
02000000000101b5d5a5c7f516548efbaac687114573004ecaf3c227e01b715407e85bb84a596201000000171600140f30187d8f55baa6d3051459fd8e5c6635413ae4ffffffff02107e88020000000017a9144af6d047bbb0999be644a054a562e8fbce68c90387a07f88020000000017a914bd3996bb9a6c401da7e65d4dbb3a9b978cd045ec870247304402200c3d4aa6f9964a13e6b90b577f806923c3783dfed1381bf52aa0b1693ab5a9e20220054cbe00b6194cbe47dc4b48431a8ca378076626e8df8a34bf8b97cdc2bed47a012102c692df13e3749aeb65867935fe6ac4b2209de5af343e33026de10dfe28c7021a00000000
02000000000101205d369f87f7961fa6b4d2ac90c88b798d3350ede3322e38c1571201d38c8fb30100000000ffffffff02084b87020000000017a914bd3996bb9a6c401da7e65d4dbb3a9b978cd045ec8770b3890200000000160014dbe2b5b174943a51c77906152e174cbadbfa221102473044022035c5a9b2fe363b0c828cb04b25e02ed16bbd96174790312110b08b0b7766eae002202c829c5af56e2a9f36878c1f7cb875334fb8f19da1b08eea467ac70327b31a0b012103b4b0846aa01f17b5fc9bbe5f47a74fec60d95c41841ee3f8b33cfcc1d3071ea500000000
02000000000101b8750ab1693891727f99c251e3b1282731628bd2690abfd2421d6a86ccdb61c7010000001716001444fa86792b21b82401b5c161d234467f67d52a9dffffffff01887d88020000000017a914bd3996bb9a6c401da7e65d4dbb3a9b978cd045ec8702473044022007f92ce19d79a6c50b4ce2e362adc281b50d4fb793ca4eee909e4e43c0c214150220152deed6df0ab105a54f8521fdf2962452ca6b8482bda9ea2d4c01dbb1bc7abd012102675b4ac4f6e2e25eb56f00a4ca284a59efdb3ccad279a1a33d68c9784c56aa3600000000
02000000000101882378f62ecaa3b7ac5e94479fcdb5795f4899d2dba22287d9eac550479036620100000000ffffffff01ffb289020000000017a914bd3996bb9a6c401da7e65d4dbb3a9b978cd045ec870247304402200822c12f52e0a11671c2f90c0b5af55281b12bf43f0c9b9f0a78e9134609e06b022067e8e47c32f2d7fcc737828621fe2a741e4ee3b4754c1143e03e12d86354b7c7012103ce631e50d09126256d0369a79b7d9b5c856683720687249a745daee589c78e3300000000
2
cQCrT9Ncs9729ao7jbmAWrD9z7tF64s2yKzmD6nkiLAi9sXVZWAn
cP65UeSDZPiTLB6CBwasWv9oJYEjRgQXhswfwcT9HscEKDcEbgy4
1
y

y
INPUT
