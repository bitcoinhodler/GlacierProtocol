#!/bin/bash
set -e

# Test withdrawing from transactions that were created by SegWit wallets.
# I have four transactions to try:
# 1. Electrum p2wpkh-in-p2sh with change
# 2. Electrum native p2wpkh with change
# 3. Electrum p2wpkh-in-p2sh with no change
# 4. Electrum native p2wpkh with no change


$GLACIERSCRIPT --regtest=$1 create-withdrawal-data << INPUT 2>&1
y
y
y
y
y
y
2NAVkgszAvjZZwWpHpbCaxSaNqCCXPD8Bts
522103d14ddcfb6817f5579695bbb3eb3e185887bf2942b031e6f716343b8fe7e9e8e221028fcd46f8614b2cbf318096968242a1e22bcfb6d8f2b6dc939c8c27c347b2937b210315acb550120f4cdcb460d5c49080ab508ca4ccd8dedecac22feeac8cd017d4c121022b063ee2f22f9e1982c140fe778672c683111a796dcccdbd47bb65e3d608a98354ae
2N5PvoFj6adLPcqHAD24MxEZxvdQMGBLXow
4
02000000000101ae06418006ec7363e02a05f450b4bff158cdee12d9157ad9c5d60884244b5ff80100000017160014f2e8500abe9631777a16cc1ed7a1443826f26931ffffffff02107e88020000000017a91413b828c9e33394691a667bf3ce461d9f923a20f287a07f88020000000017a914bd3996bb9a6c401da7e65d4dbb3a9b978cd045ec870247304402202eaae47d77af40f77a441484958e21ca8b7caba83c9488f2aad200a3a3e14cc502207ef53fd42f061b2191617557daac626a18cbf503ecae9e9c8539589bdc119cd3012103d998944b6ddffc204182ff2b9f44eb378ee829cb5977f8219002dc27eb00bfb700000000
020000000001015d272af645ccf3c8f2f24aa1e00936c50551c37c4dc77bed1ccc648500efdf490100000000ffffffff02084b87020000000017a914bd3996bb9a6c401da7e65d4dbb3a9b978cd045ec8770b389020000000016001462d27332f38c82f272ad390a32df8b8c2b1a610002473044022017dbc0bd25b3362802beca972ecaf7310f69adb0aa755c8479f604a0d654f51f0220076538134159563e3dd81b67f43b817b8090476ee5e944fb08a6ca92a88e5202012102650d89b98b7b0228c70b4b584b8851765fce7d17231c3febb2efa0404cd3f04e00000000
02000000000101743812b9aa3eceeb569c03543ed72a31de40912da0191f76661b7103b1eddf4701000000171600141a457253a74fdf1bd6d5309f8a2c8d37c3109f28ffffffff01887d88020000000017a914bd3996bb9a6c401da7e65d4dbb3a9b978cd045ec870247304402205fd9c853e1d35164666c4051661458b74694b00968d4475a523d1b4b33c1b9b4022074c6f08f188800645994072f0cd87aef9604140d57e772c8ef2bcb68b92af8000121030cf09d67431dee14a9279d9c57e17ed7580e1898444a5594667133786a10b90b00000000
02000000000101f0ff47bd1cfff027cc8ffc6174c538b228e4fa960a05fe3ca46191ff32fa40490100000000ffffffff01ffb289020000000017a914bd3996bb9a6c401da7e65d4dbb3a9b978cd045ec8702473044022019851ddcf0e06b86de01cc965fd7467732883a1c2e2866e51f13dc5cca86f82b02205246465ba302471a7393613a3b5f613011336be43af8eb05907bf7e7e3127cc6012102e6df1c0ca070c76b0a481ab58475371c68e8d4e24c11cfae421bf040099fdad800000000
2
cQCrT9Ncs9729ao7jbmAWrD9z7tF64s2yKzmD6nkiLAi9sXVZWAn
cP65UeSDZPiTLB6CBwasWv9oJYEjRgQXhswfwcT9HscEKDcEbgy4
1
y

y
INPUT
