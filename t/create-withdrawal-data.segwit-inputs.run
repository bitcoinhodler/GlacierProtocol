#!/bin/bash
set -e

# Test withdrawing from transactions that were created by SegWit wallets.
# I have four transactions to try:
# 1. Electrum p2wpkh-in-p2sh with change
# 2. Electrum native p2wpkh with change
# 3. Electrum p2wpkh-in-p2sh with no change
# 4. Electrum native p2wpkh with no change


$GLACIERSCRIPT --regtest=$1 create-withdrawal-data << INPUT 2>&1
y
y
y
y
y
y
2NAVkgszAvjZZwWpHpbCaxSaNqCCXPD8Bts
522103d14ddcfb6817f5579695bbb3eb3e185887bf2942b031e6f716343b8fe7e9e8e221028fcd46f8614b2cbf318096968242a1e22bcfb6d8f2b6dc939c8c27c347b2937b210315acb550120f4cdcb460d5c49080ab508ca4ccd8dedecac22feeac8cd017d4c121022b063ee2f22f9e1982c140fe778672c683111a796dcccdbd47bb65e3d608a98354ae
2N5PvoFj6adLPcqHAD24MxEZxvdQMGBLXow
4
02000000000101dbdc9f7630e671fceb32a12e9f4ca8025c7545f989f42fe08739f1fad30464f20100000017160014475a5004dac79cb8ca2fed8ccf13b2375ba6c191ffffffff02107e88020000000017a9145f77c7e6ce642bbe19ae0650536a1d7d5b85011c87a07f88020000000017a914bd3996bb9a6c401da7e65d4dbb3a9b978cd045ec8702473044022043b81b27eccd343aa178052796715f9e05ad12de76f1b026ed762f90b31d11fb022037291dff4e02681d6304260456c84e301409d28760c5a7341aa867e515a911960121023830d0c356e1f0353ac649435cf10292e1eb24335bdd85566e65835a0c2f36e600000000
0200000000010167360a576d9aa98be217a97815eb32f96074356189d763d583676967e1a8277c0100000000ffffffff02084b87020000000017a914bd3996bb9a6c401da7e65d4dbb3a9b978cd045ec8770b38902000000001600149b2590de667422a14eaa25906845300a649212be024730440220758e1350558798dae360f00db156fbbcec64eccc52e0726669015120ebe42af30220460872704edc14dcf5d81a1913f871c10a20ab123e7ed401392dba978774d2ea012102e36819dd23bb1ed13584d32b52826f05fe810beed7f69df5d6a97dd8f14e81af00000000
02000000000101fafb186b53d6f03b8329bc0651c481bd5067576b43f67f02e426ed338401a3dd0100000017160014931a53f12f2749e71a3bd2f5a4fe20fdbb07da62ffffffff01887d88020000000017a914bd3996bb9a6c401da7e65d4dbb3a9b978cd045ec87024730440220276b468638262f898bb958ec458f37ecc5b2c444ff3d6d7334a1630e61fa110402207aa231f0735b0a1d8f398d4bad97fa6da8b0996fc59c9515985dd55d78941302012103db5f36898e41812d2ee15d385d012a0a091a7db92bc24280a0c549a3f90206b900000000
020000000001019444e23713a4535d2521976548309d26cc3d972b931c86260b67330633b5b7b80100000000ffffffff01ffb289020000000017a914bd3996bb9a6c401da7e65d4dbb3a9b978cd045ec870247304402203d399b2adebb47f7f9d687af436937b38f8c5be73d3a689f9154261a271586db022035807a0ba6710dc803ce79ed4e1d388a342cb8b5c89e2437fed01ffc051941cd0121021b5ef0fb6156310f433953394e8f1ade80c0afc99e1a09aee1c9fc68575d5ea900000000
2
cQCrT9Ncs9729ao7jbmAWrD9z7tF64s2yKzmD6nkiLAi9sXVZWAn
cP65UeSDZPiTLB6CBwasWv9oJYEjRgQXhswfwcT9HscEKDcEbgy4
1
y

y
INPUT
