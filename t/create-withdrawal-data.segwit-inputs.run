#!/bin/bash
set -e

# Test withdrawing from transactions that were created by SegWit wallets.
# I have four transactions to try:
# 1. Electrum p2wpkh-in-p2sh with change
# 2. Electrum native p2wpkh with change
# 3. Electrum p2wpkh-in-p2sh with no change
# 4. Electrum native p2wpkh with no change


$GLACIERSCRIPT --regtest=$1 create-withdrawal-data << INPUT 2>&1
y
y
y
y
y
y
2NAVkgszAvjZZwWpHpbCaxSaNqCCXPD8Bts
522103d14ddcfb6817f5579695bbb3eb3e185887bf2942b031e6f716343b8fe7e9e8e221028fcd46f8614b2cbf318096968242a1e22bcfb6d8f2b6dc939c8c27c347b2937b210315acb550120f4cdcb460d5c49080ab508ca4ccd8dedecac22feeac8cd017d4c121022b063ee2f22f9e1982c140fe778672c683111a796dcccdbd47bb65e3d608a98354ae
2N5PvoFj6adLPcqHAD24MxEZxvdQMGBLXow
4
020000000001018aba57c7a9d2cd0c7f9a1754d1b8515959ac1ddc146e167d041235daabfe1afc010000001716001498d0d617191ce523831b68606b69d8576cdbdc31ffffffff02107e88020000000017a914f71b76ad8fa023ff04943edeef5a0cf0f181a1ff87a07f88020000000017a914bd3996bb9a6c401da7e65d4dbb3a9b978cd045ec870247304402200d986cfc1d2916f7739a4df3ba42e8e96a835ac9c30cf9ca2b344cf757d75186022049ac056a9e62b23098def35b3ccd7d5785e0a61c540b78bb84d4256eca7a82fb012103f07beabf0680bc085f1cdbbb8a9c1201fccf9c284c70db60ecb21196ba53a69200000000
02000000000101f43b5050f0826d7ffc1c34e934fce8e0598c1090bd48b6b00659596f19e7e08a0100000000ffffffff02084b87020000000017a914bd3996bb9a6c401da7e65d4dbb3a9b978cd045ec8770b3890200000000160014a9d31b7bb65565921febc103586683f817e68e8d024730440220747bd6491cb36bddc5a3dc5d0eeb83ba7bf4e8657ccfe65cea07e58718ae632a022017bab3ffaba0129a56b50b71dfbef3ebf3ae51573f87a4b3baa808893b6e9e470121039f022cdfc7c789f523cbfce54f1f2adfd15a9b7add567afacf7ebebefa14c6bd00000000
0200000000010111e1801ef59346285a1a9815eac017df5b64af4c17fddf0a990a89f7fd3f588f010000001716001480832463c61c72988c08b94b6b61596a1f421efdffffffff01887d88020000000017a914bd3996bb9a6c401da7e65d4dbb3a9b978cd045ec870247304402203985f717d34d58b535bea16470da15fbbf60ad601ef91651e46b3d2c78fc7b7a0220332c9380e0876c1f9d31fcebd61a73ea371e9b4ce10eafd097fdc6f2ab4041590121029cc389ae66672f093648517a81bf5b979322dc486fcf17fd7da9161608382c0e00000000
020000000001016affe3ec0db63d5489e721d6e9c8a737526ecb72fefc2cda77943bbea4e93ad20100000000ffffffff01ffb289020000000017a914bd3996bb9a6c401da7e65d4dbb3a9b978cd045ec87024730440220147a84292585de567cab35a9409cf34870646b26b91085b4656342a1b5066ea402207392bfe0e11c4c458ff0b007072ed04c5602b8bc19b8e028aa53d28cdbca54580121034fe3a37e1404aaf8e70f373114652bfdda52dfb3da240df0937b084a683fef3900000000
2
cQCrT9Ncs9729ao7jbmAWrD9z7tF64s2yKzmD6nkiLAi9sXVZWAn
cP65UeSDZPiTLB6CBwasWv9oJYEjRgQXhswfwcT9HscEKDcEbgy4
1
y

y
INPUT
