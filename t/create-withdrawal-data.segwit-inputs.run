#!/bin/bash
set -e

# Test withdrawing from transactions that were created by SegWit wallets.
# I have four transactions to try:
# 1. Electrum p2wpkh-in-p2sh with change
# 2. Electrum native p2wpkh with change
# 3. Electrum p2wpkh-in-p2sh with no change
# 4. Electrum native p2wpkh with no change


$GLACIERSCRIPT --regtest=$1 create-withdrawal-data << INPUT
y
y
y
y
y
y
2NAVkgszAvjZZwWpHpbCaxSaNqCCXPD8Bts
522103d14ddcfb6817f5579695bbb3eb3e185887bf2942b031e6f716343b8fe7e9e8e221028fcd46f8614b2cbf318096968242a1e22bcfb6d8f2b6dc939c8c27c347b2937b210315acb550120f4cdcb460d5c49080ab508ca4ccd8dedecac22feeac8cd017d4c121022b063ee2f22f9e1982c140fe778672c683111a796dcccdbd47bb65e3d608a98354ae
2N5PvoFj6adLPcqHAD24MxEZxvdQMGBLXow
4
020000000001017707a8295eeca54c063136b719a0a06da59036b8f0522f8827945968717df5e901000000171600148edf85a133f22c65164e7377b99331be3b0e94caffffffff02107e88020000000017a914a7ae2c4651ab2a0ae39ae586d307b50012220a7887a07f88020000000017a914bd3996bb9a6c401da7e65d4dbb3a9b978cd045ec8702473044022056073d62416741363cb4e0f414b1bf03e2acc81c7b92fb53053e7473a0c14b8c02200e112dfc7fcda4fb170f8906001af0ad6066cc483075adb5b30d7c79525e0b52012103e70511c76bd658fc30328cfc391948386179d8196d34a37a530a7c3cc679a16400000000
02000000000101121c8818422e862ecb5fcd270fc8a5cf6d4ed95ff645728a1c0a3b15ebe72db60100000000ffffffff02084b87020000000017a914bd3996bb9a6c401da7e65d4dbb3a9b978cd045ec8770b3890200000000160014e47ceb06bc19e2ca4327b1cd7fe9c30b7266a3230247304402201bf220aa644eba8c837fba243450d25c541e5a18e6cc2a940918fb6efd9ddc26022074ac5c3b63d020648aad7aeb155655acfe79e31456af1c62dccdec23f2ecc502012103d20cdfa9b6aa0785394f4fef8849086ac6bab2a9f28c805f701ec25af1bf067d00000000
0200000000010170c4514f421c19f27b69d1f462aca905d75a128be209aa2fec2328d647e7631c010000001716001492ed94266db764932f80d55007caf2e35e3622f3ffffffff01887d88020000000017a914bd3996bb9a6c401da7e65d4dbb3a9b978cd045ec8702473044022017ad125f5803cd0f08687ea821c6e7ade566a3545bbd60b8a2eb00b7c670a7c502205796e64e61f2bb37a50b9cbefce1306a9490b5ad2c2c569db418287b83f3edc50121025e4e5ff22bd2acadf9422670e452cb3ff38a0887683590232174f458ce6ae0ea00000000
02000000000101e3713bcd11594b0489a9900e3fd1633111ec02c803808492ebffecacd06ad4cc0100000000ffffffff01ffb289020000000017a914bd3996bb9a6c401da7e65d4dbb3a9b978cd045ec870247304402206ef78f48652f667ed9c2f7521d3fc8aeca7f3804b0eb0557d70f64e0b892fefe022006916b45d11ca0a10a42db4caf677e7aea8eebbd9c1d908a270ce83808b26c1f01210339a310c7045faeb0e98b68c4bda3fdbd9abdab35c705b0c3915f10255a7d77fb00000000
2
cQCrT9Ncs9729ao7jbmAWrD9z7tF64s2yKzmD6nkiLAi9sXVZWAn
cP65UeSDZPiTLB6CBwasWv9oJYEjRgQXhswfwcT9HscEKDcEbgy4
1
y

y
INPUT
