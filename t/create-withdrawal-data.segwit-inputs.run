#!/bin/bash
set -e

# Test withdrawing from transactions that were created by SegWit wallets.
# I have four transactions to try:
# 1. Electrum p2wpkh-in-p2sh with change
# 2. Electrum native p2wpkh with change
# 3. Electrum p2wpkh-in-p2sh with no change
# 4. Electrum native p2wpkh with no change


$GLACIERSCRIPT --regtest=$1 create-withdrawal-data << INPUT
y
y
y
y
y
y
2NAVkgszAvjZZwWpHpbCaxSaNqCCXPD8Bts
522103d14ddcfb6817f5579695bbb3eb3e185887bf2942b031e6f716343b8fe7e9e8e221028fcd46f8614b2cbf318096968242a1e22bcfb6d8f2b6dc939c8c27c347b2937b210315acb550120f4cdcb460d5c49080ab508ca4ccd8dedecac22feeac8cd017d4c121022b063ee2f22f9e1982c140fe778672c683111a796dcccdbd47bb65e3d608a98354ae
2N5PvoFj6adLPcqHAD24MxEZxvdQMGBLXow
4
02000000000101aec02d97e0d2441d19f6094d53dd93199a46f006801a1751c706b84f24e05c1b0100000017160014e036300e9d4c5ab5a752fb25bc938906af71043affffffff02107e88020000000017a914d6048ef69b592887804750d7381be3ea6140947b87a07f88020000000017a914bd3996bb9a6c401da7e65d4dbb3a9b978cd045ec8702473044022051b6a720f23c5a558f6932730d7433fc204c02cdf73cd5bee5b0aa89ed45ec300220572a69eeaec0a4d8d95ac902a4a88076402a40497de0665f0c4ea5a325484e9801210365aec22c4e2b96d877c31e3ade951ce95322e169997e1b24e9e29ce4032240e800000000
02000000000101c7ff07e2c0a9efbe50b1f1612fce3fdf8d189fbf80ac7fc0bbaa3fb4cf8a5f730100000000ffffffff02084b87020000000017a914bd3996bb9a6c401da7e65d4dbb3a9b978cd045ec8770b38902000000001600141392ec057ca93a2395930d95073c25187b75994a0247304402203f8923bde71322fede11dbad7ae4558ae286f59f31e2ede68897f135df3b5375022074fc06070b60ec85b32e1fe1037e09a4f0dc4bcc7360025789b1337d6f5d4d800121020b57212cabe7696b5599f84bc6236df27d978a9bdfab6746383e21241667116400000000
02000000000101a7cd2d126ec5f71409608fc88ba33b5e6bc739bc2430bafd9e54a80e76de15c601000000171600148e7c7c3d1b26a76eb95cbaef0177ec1d33e0165effffffff01887d88020000000017a914bd3996bb9a6c401da7e65d4dbb3a9b978cd045ec870247304402204b9c305340f7d32387561812b38bc9ed93d63a02d6cf7a47ff1fcdf8ec941c1102206ea03d572e78f6647de7692cc6a009a7cc05b22a96126dadf80bc426a84e58040121025352a90805dbc7f6e41d94d4e2cabefa35abd3334910b0da7066899981f4209900000000
020000000001016df4c7552c9b5ade24e4aa25b9e4bb17f1c8f89a2717907a99e4f85b30bcd01b0100000000ffffffff01ffb289020000000017a914bd3996bb9a6c401da7e65d4dbb3a9b978cd045ec8702473044022070061d3f97284b5ea81a7a24e77fdb05ee1e517a5aa208ec4034afd52b517b2002205262fbce18cad508fc1bf429cf3bf682e261f038ad1e3384f1208b80bc351c7f012103ee445cf0b5dfe98bd063d00c5377aa6aba3d8b630f297a5a53904664f05c649500000000
2
cQCrT9Ncs9729ao7jbmAWrD9z7tF64s2yKzmD6nkiLAi9sXVZWAn
cP65UeSDZPiTLB6CBwasWv9oJYEjRgQXhswfwcT9HscEKDcEbgy4
1
y

y
INPUT
