#!/bin/bash
set -e

# Test withdrawing from transactions that were created by SegWit wallets.
# I have four transactions to try:
# 1. Electrum p2wpkh-in-p2sh with change
# 2. Electrum native p2wpkh with change
# 3. Electrum p2wpkh-in-p2sh with no change
# 4. Electrum native p2wpkh with no change


$GLACIERSCRIPT --regtest=$1 create-withdrawal-data << INPUT 2>&1
y
y
y
y
y
y
2NAVkgszAvjZZwWpHpbCaxSaNqCCXPD8Bts
522103d14ddcfb6817f5579695bbb3eb3e185887bf2942b031e6f716343b8fe7e9e8e221028fcd46f8614b2cbf318096968242a1e22bcfb6d8f2b6dc939c8c27c347b2937b210315acb550120f4cdcb460d5c49080ab508ca4ccd8dedecac22feeac8cd017d4c121022b063ee2f22f9e1982c140fe778672c683111a796dcccdbd47bb65e3d608a98354ae
2N5PvoFj6adLPcqHAD24MxEZxvdQMGBLXow
4
02000000000101b4fdb7836186bb84e756f4c3185b8463ebbe12544c9b427b55f7f3b27190ccd20100000017160014f2e8500abe9631777a16cc1ed7a1443826f26931ffffffff02107e88020000000017a91413b828c9e33394691a667bf3ce461d9f923a20f287a07f88020000000017a914bd3996bb9a6c401da7e65d4dbb3a9b978cd045ec870247304402202dff87bed4aeaf2efb52e849a574ffa078a28f6acb953804f5c16786e50250ce02204079a82fae42454ccd3a53fa9d6e0e2cbd0a46f08ba44c55756372cbcb37e2d1012103d998944b6ddffc204182ff2b9f44eb378ee829cb5977f8219002dc27eb00bfb700000000
020000000001015d272af645ccf3c8f2f24aa1e00936c50551c37c4dc77bed1ccc648500efdf490100000000ffffffff02084b87020000000017a914bd3996bb9a6c401da7e65d4dbb3a9b978cd045ec8770b389020000000016001462d27332f38c82f272ad390a32df8b8c2b1a610002473044022017dbc0bd25b3362802beca972ecaf7310f69adb0aa755c8479f604a0d654f51f0220076538134159563e3dd81b67f43b817b8090476ee5e944fb08a6ca92a88e5202012102650d89b98b7b0228c70b4b584b8851765fce7d17231c3febb2efa0404cd3f04e00000000
02000000000101e82f8a0c36dd1a17f98fc9df731b17cb303019c5b87e20f1ff0b181919003f0a01000000171600141a457253a74fdf1bd6d5309f8a2c8d37c3109f28ffffffff01887d88020000000017a914bd3996bb9a6c401da7e65d4dbb3a9b978cd045ec8702473044022023bdecf46eed119e7736d0396ce836a279008757645e96b9f811845db8088c6b02204b952acb4f1cf39eb21e52f8414796fb8262b8aeed80597e5b55e26ecf9ea85d0121030cf09d67431dee14a9279d9c57e17ed7580e1898444a5594667133786a10b90b00000000
02000000000101dfa897acd3c450916596373fbf973e23994ba77a20e4666053a339bc2c41dc920100000000ffffffff01ffb289020000000017a914bd3996bb9a6c401da7e65d4dbb3a9b978cd045ec870247304402203010e4b2b080c19931ca16124549503adb6a4bd0ae4cee3cc319e01c31f2202902205f84e349e50b29dd20e36e1225a1c2bc51bf045d9fc627aa4b5bf0cef6896a00012102e6df1c0ca070c76b0a481ab58475371c68e8d4e24c11cfae421bf040099fdad800000000
2
cQCrT9Ncs9729ao7jbmAWrD9z7tF64s2yKzmD6nkiLAi9sXVZWAn
cP65UeSDZPiTLB6CBwasWv9oJYEjRgQXhswfwcT9HscEKDcEbgy4
1
y

y
INPUT
